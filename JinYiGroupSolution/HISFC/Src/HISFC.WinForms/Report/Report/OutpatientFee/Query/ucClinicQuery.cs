using System;
using System.Collections;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Neusoft.WinForms.Report.OutpatientFee
{
    public partial class ucClinicQuery : Neusoft.FrameWork.WinForms.Controls.ucBaseControl
    {
         #region 自动生成的代码
		private System.Windows.Forms.TabControl tabControl1;
		private System.Windows.Forms.ComboBox comboBoxPatientCondition;
        private System.Windows.Forms.ComboBox comboBoxOperate;
		private System.Windows.Forms.TabPage tabPageRegisteQuery;
		private System.Windows.Forms.Label label1;
		private System.Windows.Forms.CheckBox checkBoxRegisteDate;
		private System.Windows.Forms.Label label2;
		private System.Windows.Forms.DateTimePicker dateTimePickerRegisteFrom;
		private System.Windows.Forms.DateTimePicker dateTimePickerRegisteTo;
		private System.Windows.Forms.Label label3;
		private System.Windows.Forms.Label label4;
		private System.Windows.Forms.Label label5;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxCardCode;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxClinicCode;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxPatientName;
		private System.Windows.Forms.Label label6;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxAgeAndSex;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxRegisteDate;
		private System.Windows.Forms.Label label7;
		private System.Windows.Forms.Label label8;
		private System.Windows.Forms.Label label9;
		private System.Windows.Forms.Label label10;
		private System.Windows.Forms.Label label11;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxIDCard;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxBornDate;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxBalanceType;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxPactName;
		private System.Windows.Forms.Label label12;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxMCardCode;
		private System.Windows.Forms.Label label13;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxRegistLevel;
		private System.Windows.Forms.Label label14;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxRegistDepartment;
		private System.Windows.Forms.Label label15;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxRegistDoctor;
		private System.Windows.Forms.Label label16;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxSeeDepartment;
		private System.Windows.Forms.Label label17;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxSeeDoctor;
		private System.Windows.Forms.Panel panelRegister;
		private System.Windows.Forms.Panel panelRegistCondition;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxRegisteInvoice;
		private System.Windows.Forms.Label label18;
		private System.Windows.Forms.Label label19;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxFeeRegist;
		private System.Windows.Forms.Label label20;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxFeeCheck;
		private System.Windows.Forms.Label label21;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxFeeOther;
		private System.Windows.Forms.Label label22;
		private Neusoft.FrameWork.WinForms.Controls.NeuTextBox textBoxFeeDiagnose;
		private System.Windows.Forms.Panel panelRegistRecord;
		private FarPoint.Win.Spread.FpSpread fpSpreadRegistRecord;
        private FarPoint.Win.Spread.SheetView SheetRegistRecord;
        private System.Windows.Forms.TabPage tabPageInvoiceQuery;
		private FarPoint.Win.Spread.FpSpread fpSpreadFeeDetail;
        private FarPoint.Win.Spread.SheetView SheetFeeDetail;
        private Neusoft.FrameWork.WinForms.Controls.NeuListTextBox textBoxPatientCondition;
        private TabPage tabPageOrderQuery;
        private Neusoft.HISFC.Components.Order.OutPatient.Controls.ucOrderHistory ucOrderHistory1;
        private TabPage tabPagePatientInfo;
        private Neusoft.HISFC.Components.Account.Controls.ucRegPatientInfo ucRegPatientInfo1;
		private System.ComponentModel.IContainer components;

		public ucClinicQuery()
		{
			//
			// Windows 窗体设计器支持所必需的
			//
			InitializeComponent();

			//
			// TODO: 在 InitializeComponent 调用后添加任何构造函数代码
			//
		}

		/// <summary>
		/// 清理所有正在使用的资源。
		/// </summary>
		protected override void Dispose( bool disposing )
		{
			if( disposing )
			{
				if(components != null)
				{
					components.Dispose();
				}
			}
			base.Dispose( disposing );
		}

		#region Windows 窗体设计器生成的代码
		/// <summary>
		/// 设计器支持所需的方法 - 不要使用代码编辑器修改
		/// 此方法的内容。
		/// </summary>
		private void InitializeComponent()
		{
            FarPoint.Win.Spread.TipAppearance tipAppearance3 = new FarPoint.Win.Spread.TipAppearance();
            FarPoint.Win.Spread.CellType.TextCellType textCellType11 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType12 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType13 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType14 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType15 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType16 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType17 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType18 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType19 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.CellType.TextCellType textCellType20 = new FarPoint.Win.Spread.CellType.TextCellType();
            FarPoint.Win.Spread.TipAppearance tipAppearance4 = new FarPoint.Win.Spread.TipAppearance();
            this.tabControl1 = new System.Windows.Forms.TabControl();
            this.tabPageRegisteQuery = new System.Windows.Forms.TabPage();
            this.panelRegistRecord = new System.Windows.Forms.Panel();
            this.fpSpreadRegistRecord = new FarPoint.Win.Spread.FpSpread();
            this.SheetRegistRecord = new FarPoint.Win.Spread.SheetView();
            this.panelRegister = new System.Windows.Forms.Panel();
            this.textBoxFeeDiagnose = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label22 = new System.Windows.Forms.Label();
            this.textBoxFeeOther = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label21 = new System.Windows.Forms.Label();
            this.textBoxFeeCheck = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label20 = new System.Windows.Forms.Label();
            this.textBoxFeeRegist = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label19 = new System.Windows.Forms.Label();
            this.textBoxRegisteInvoice = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label18 = new System.Windows.Forms.Label();
            this.textBoxSeeDoctor = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label17 = new System.Windows.Forms.Label();
            this.textBoxSeeDepartment = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label16 = new System.Windows.Forms.Label();
            this.textBoxRegistDoctor = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label15 = new System.Windows.Forms.Label();
            this.textBoxRegistDepartment = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label14 = new System.Windows.Forms.Label();
            this.textBoxRegistLevel = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label13 = new System.Windows.Forms.Label();
            this.textBoxMCardCode = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label12 = new System.Windows.Forms.Label();
            this.textBoxPactName = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label11 = new System.Windows.Forms.Label();
            this.textBoxBalanceType = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label10 = new System.Windows.Forms.Label();
            this.textBoxBornDate = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label9 = new System.Windows.Forms.Label();
            this.textBoxIDCard = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label8 = new System.Windows.Forms.Label();
            this.textBoxRegisteDate = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label7 = new System.Windows.Forms.Label();
            this.textBoxAgeAndSex = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label6 = new System.Windows.Forms.Label();
            this.textBoxPatientName = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label5 = new System.Windows.Forms.Label();
            this.textBoxClinicCode = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label4 = new System.Windows.Forms.Label();
            this.textBoxCardCode = new Neusoft.FrameWork.WinForms.Controls.NeuTextBox();
            this.label3 = new System.Windows.Forms.Label();
            this.panelRegistCondition = new System.Windows.Forms.Panel();
            this.textBoxPatientCondition = new Neusoft.FrameWork.WinForms.Controls.NeuListTextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.dateTimePickerRegisteTo = new System.Windows.Forms.DateTimePicker();
            this.dateTimePickerRegisteFrom = new System.Windows.Forms.DateTimePicker();
            this.checkBoxRegisteDate = new System.Windows.Forms.CheckBox();
            this.label1 = new System.Windows.Forms.Label();
            this.comboBoxOperate = new System.Windows.Forms.ComboBox();
            this.comboBoxPatientCondition = new System.Windows.Forms.ComboBox();
            this.tabPagePatientInfo = new System.Windows.Forms.TabPage();
            this.ucRegPatientInfo1 = new Neusoft.HISFC.Components.Account.Controls.ucRegPatientInfo();
            this.tabPageInvoiceQuery = new System.Windows.Forms.TabPage();
            this.fpSpreadFeeDetail = new FarPoint.Win.Spread.FpSpread();
            this.SheetFeeDetail = new FarPoint.Win.Spread.SheetView();
            this.tabPageOrderQuery = new System.Windows.Forms.TabPage();
            this.ucOrderHistory1 = new Neusoft.HISFC.Components.Order.OutPatient.Controls.ucOrderHistory();
            this.tabControl1.SuspendLayout();
            this.tabPageRegisteQuery.SuspendLayout();
            this.panelRegistRecord.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.fpSpreadRegistRecord)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.SheetRegistRecord)).BeginInit();
            this.panelRegister.SuspendLayout();
            this.panelRegistCondition.SuspendLayout();
            this.tabPagePatientInfo.SuspendLayout();
            this.tabPageInvoiceQuery.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.fpSpreadFeeDetail)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.SheetFeeDetail)).BeginInit();
            this.tabPageOrderQuery.SuspendLayout();
            this.SuspendLayout();
            // 
            // tabControl1
            // 
            this.tabControl1.Controls.Add(this.tabPageRegisteQuery);
            this.tabControl1.Controls.Add(this.tabPagePatientInfo);
            this.tabControl1.Controls.Add(this.tabPageInvoiceQuery);
            this.tabControl1.Controls.Add(this.tabPageOrderQuery);
            this.tabControl1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.tabControl1.Location = new System.Drawing.Point(0, 0);
            this.tabControl1.Name = "tabControl1";
            this.tabControl1.SelectedIndex = 0;
            this.tabControl1.Size = new System.Drawing.Size(789, 421);
            this.tabControl1.TabIndex = 2;
            // 
            // tabPageRegisteQuery
            // 
            this.tabPageRegisteQuery.Controls.Add(this.panelRegistRecord);
            this.tabPageRegisteQuery.Controls.Add(this.panelRegister);
            this.tabPageRegisteQuery.Controls.Add(this.panelRegistCondition);
            this.tabPageRegisteQuery.ImageIndex = 0;
            this.tabPageRegisteQuery.Location = new System.Drawing.Point(4, 22);
            this.tabPageRegisteQuery.Name = "tabPageRegisteQuery";
            this.tabPageRegisteQuery.Size = new System.Drawing.Size(781, 395);
            this.tabPageRegisteQuery.TabIndex = 0;
            this.tabPageRegisteQuery.Text = "挂号信息查询";
            this.tabPageRegisteQuery.UseVisualStyleBackColor = true;
            // 
            // panelRegistRecord
            // 
            this.panelRegistRecord.Controls.Add(this.fpSpreadRegistRecord);
            this.panelRegistRecord.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panelRegistRecord.Location = new System.Drawing.Point(0, 160);
            this.panelRegistRecord.Name = "panelRegistRecord";
            this.panelRegistRecord.Size = new System.Drawing.Size(781, 235);
            this.panelRegistRecord.TabIndex = 2;
            // 
            // fpSpreadRegistRecord
            // 
            this.fpSpreadRegistRecord.About = "3.0.2004.2005";
            this.fpSpreadRegistRecord.AccessibleDescription = "fpSpreadRegistRecord, Sheet1, Row 0, Column 0, ";
            this.fpSpreadRegistRecord.BackColor = System.Drawing.SystemColors.Control;
            this.fpSpreadRegistRecord.Dock = System.Windows.Forms.DockStyle.Fill;
            this.fpSpreadRegistRecord.Location = new System.Drawing.Point(0, 0);
            this.fpSpreadRegistRecord.Name = "fpSpreadRegistRecord";
            this.fpSpreadRegistRecord.Sheets.AddRange(new FarPoint.Win.Spread.SheetView[] {
            this.SheetRegistRecord});
            this.fpSpreadRegistRecord.Size = new System.Drawing.Size(781, 235);
            this.fpSpreadRegistRecord.TabIndex = 0;
            tipAppearance3.BackColor = System.Drawing.SystemColors.Info;
            tipAppearance3.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            tipAppearance3.ForeColor = System.Drawing.SystemColors.InfoText;
            this.fpSpreadRegistRecord.TextTipAppearance = tipAppearance3;
            this.fpSpreadRegistRecord.CellDoubleClick += new FarPoint.Win.Spread.CellClickEventHandler(this.fpSpreadRegistRecord_CellDoubleClick);
            this.fpSpreadRegistRecord.CellClick += new FarPoint.Win.Spread.CellClickEventHandler(this.fpSpreadRegistRecord_CellClick);
            // 
            // SheetRegistRecord
            // 
            this.SheetRegistRecord.Reset();
            this.SheetRegistRecord.SheetName = "Sheet1";
            // Formulas and custom names must be loaded with R1C1 reference style
            this.SheetRegistRecord.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.R1C1;
            this.SheetRegistRecord.ColumnCount = 11;
            this.SheetRegistRecord.RowCount = 0;
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 0).Value = "病历号码";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 1).Value = "患者姓名";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 2).Value = "挂号日期";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 3).Value = "结算类别";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 4).Value = "合同单位";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 5).Value = "挂号级别";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 6).Value = "挂号科室";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 7).Value = "挂号医生";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 8).Value = "看诊序号";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 9).Value = "是否有效?";
            this.SheetRegistRecord.ColumnHeader.Cells.Get(0, 10).Value = "退号时间";
            this.SheetRegistRecord.Columns.Get(0).CellType = textCellType11;
            this.SheetRegistRecord.Columns.Get(0).Label = "病历号码";
            this.SheetRegistRecord.Columns.Get(0).Width = 100F;
            this.SheetRegistRecord.Columns.Get(1).CellType = textCellType12;
            this.SheetRegistRecord.Columns.Get(1).Label = "患者姓名";
            this.SheetRegistRecord.Columns.Get(1).Width = 80F;
            this.SheetRegistRecord.Columns.Get(2).CellType = textCellType13;
            this.SheetRegistRecord.Columns.Get(2).Label = "挂号日期";
            this.SheetRegistRecord.Columns.Get(2).Width = 150F;
            this.SheetRegistRecord.Columns.Get(3).CellType = textCellType14;
            this.SheetRegistRecord.Columns.Get(3).Label = "结算类别";
            this.SheetRegistRecord.Columns.Get(3).Width = 80F;
            this.SheetRegistRecord.Columns.Get(4).CellType = textCellType15;
            this.SheetRegistRecord.Columns.Get(4).Label = "合同单位";
            this.SheetRegistRecord.Columns.Get(4).Width = 80F;
            this.SheetRegistRecord.Columns.Get(5).CellType = textCellType16;
            this.SheetRegistRecord.Columns.Get(5).Label = "挂号级别";
            this.SheetRegistRecord.Columns.Get(5).Width = 80F;
            this.SheetRegistRecord.Columns.Get(6).CellType = textCellType17;
            this.SheetRegistRecord.Columns.Get(6).Label = "挂号科室";
            this.SheetRegistRecord.Columns.Get(6).Width = 100F;
            this.SheetRegistRecord.Columns.Get(7).Label = "挂号医生";
            this.SheetRegistRecord.Columns.Get(7).Width = 77F;
            this.SheetRegistRecord.Columns.Get(8).CellType = textCellType18;
            this.SheetRegistRecord.Columns.Get(8).HorizontalAlignment = FarPoint.Win.Spread.CellHorizontalAlignment.Right;
            this.SheetRegistRecord.Columns.Get(8).Label = "看诊序号";
            this.SheetRegistRecord.Columns.Get(8).Width = 76F;
            this.SheetRegistRecord.Columns.Get(9).CellType = textCellType19;
            this.SheetRegistRecord.Columns.Get(9).Label = "是否有效?";
            this.SheetRegistRecord.Columns.Get(9).Width = 86F;
            this.SheetRegistRecord.Columns.Get(10).CellType = textCellType20;
            this.SheetRegistRecord.Columns.Get(10).HorizontalAlignment = FarPoint.Win.Spread.CellHorizontalAlignment.Right;
            this.SheetRegistRecord.Columns.Get(10).Label = "退号时间";
            this.SheetRegistRecord.Columns.Get(10).Width = 82F;
            this.SheetRegistRecord.RowHeader.Columns.Default.Resizable = false;
            this.SheetRegistRecord.RowHeader.Columns.Get(0).Width = 27F;
            this.SheetRegistRecord.SelectionPolicy = FarPoint.Win.Spread.Model.SelectionPolicy.Single;
            this.SheetRegistRecord.SelectionUnit = FarPoint.Win.Spread.Model.SelectionUnit.Row;
            this.SheetRegistRecord.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.A1;
            this.fpSpreadRegistRecord.SetActiveViewport(0, 1, 0);
            // 
            // panelRegister
            // 
            this.panelRegister.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.panelRegister.Controls.Add(this.textBoxFeeDiagnose);
            this.panelRegister.Controls.Add(this.label22);
            this.panelRegister.Controls.Add(this.textBoxFeeOther);
            this.panelRegister.Controls.Add(this.label21);
            this.panelRegister.Controls.Add(this.textBoxFeeCheck);
            this.panelRegister.Controls.Add(this.label20);
            this.panelRegister.Controls.Add(this.textBoxFeeRegist);
            this.panelRegister.Controls.Add(this.label19);
            this.panelRegister.Controls.Add(this.textBoxRegisteInvoice);
            this.panelRegister.Controls.Add(this.label18);
            this.panelRegister.Controls.Add(this.textBoxSeeDoctor);
            this.panelRegister.Controls.Add(this.label17);
            this.panelRegister.Controls.Add(this.textBoxSeeDepartment);
            this.panelRegister.Controls.Add(this.label16);
            this.panelRegister.Controls.Add(this.textBoxRegistDoctor);
            this.panelRegister.Controls.Add(this.label15);
            this.panelRegister.Controls.Add(this.textBoxRegistDepartment);
            this.panelRegister.Controls.Add(this.label14);
            this.panelRegister.Controls.Add(this.textBoxRegistLevel);
            this.panelRegister.Controls.Add(this.label13);
            this.panelRegister.Controls.Add(this.textBoxMCardCode);
            this.panelRegister.Controls.Add(this.label12);
            this.panelRegister.Controls.Add(this.textBoxPactName);
            this.panelRegister.Controls.Add(this.label11);
            this.panelRegister.Controls.Add(this.textBoxBalanceType);
            this.panelRegister.Controls.Add(this.label10);
            this.panelRegister.Controls.Add(this.textBoxBornDate);
            this.panelRegister.Controls.Add(this.label9);
            this.panelRegister.Controls.Add(this.textBoxIDCard);
            this.panelRegister.Controls.Add(this.label8);
            this.panelRegister.Controls.Add(this.textBoxRegisteDate);
            this.panelRegister.Controls.Add(this.label7);
            this.panelRegister.Controls.Add(this.textBoxAgeAndSex);
            this.panelRegister.Controls.Add(this.label6);
            this.panelRegister.Controls.Add(this.textBoxPatientName);
            this.panelRegister.Controls.Add(this.label5);
            this.panelRegister.Controls.Add(this.textBoxClinicCode);
            this.panelRegister.Controls.Add(this.label4);
            this.panelRegister.Controls.Add(this.textBoxCardCode);
            this.panelRegister.Controls.Add(this.label3);
            this.panelRegister.Dock = System.Windows.Forms.DockStyle.Top;
            this.panelRegister.Location = new System.Drawing.Point(0, 38);
            this.panelRegister.Name = "panelRegister";
            this.panelRegister.Size = new System.Drawing.Size(781, 122);
            this.panelRegister.TabIndex = 1;
            // 
            // textBoxFeeDiagnose
            // 
            this.textBoxFeeDiagnose.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxFeeDiagnose.IsEnter2Tab = false;
            this.textBoxFeeDiagnose.Location = new System.Drawing.Point(453, 121);
            this.textBoxFeeDiagnose.Name = "textBoxFeeDiagnose";
            this.textBoxFeeDiagnose.ReadOnly = true;
            this.textBoxFeeDiagnose.Size = new System.Drawing.Size(120, 21);
            this.textBoxFeeDiagnose.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxFeeDiagnose.TabIndex = 39;
            this.textBoxFeeDiagnose.Visible = false;
            // 
            // label22
            // 
            this.label22.Location = new System.Drawing.Point(400, 125);
            this.label22.Name = "label22";
            this.label22.Size = new System.Drawing.Size(54, 11);
            this.label22.TabIndex = 38;
            this.label22.Text = "诊 查 费";
            this.label22.Visible = false;
            // 
            // textBoxFeeOther
            // 
            this.textBoxFeeOther.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxFeeOther.IsEnter2Tab = false;
            this.textBoxFeeOther.Location = new System.Drawing.Point(646, 121);
            this.textBoxFeeOther.Name = "textBoxFeeOther";
            this.textBoxFeeOther.ReadOnly = true;
            this.textBoxFeeOther.Size = new System.Drawing.Size(120, 21);
            this.textBoxFeeOther.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxFeeOther.TabIndex = 37;
            this.textBoxFeeOther.Visible = false;
            // 
            // label21
            // 
            this.label21.Location = new System.Drawing.Point(591, 125);
            this.label21.Name = "label21";
            this.label21.Size = new System.Drawing.Size(54, 11);
            this.label21.TabIndex = 36;
            this.label21.Text = "附 加 费";
            this.label21.Visible = false;
            // 
            // textBoxFeeCheck
            // 
            this.textBoxFeeCheck.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxFeeCheck.IsEnter2Tab = false;
            this.textBoxFeeCheck.Location = new System.Drawing.Point(260, 121);
            this.textBoxFeeCheck.Name = "textBoxFeeCheck";
            this.textBoxFeeCheck.ReadOnly = true;
            this.textBoxFeeCheck.Size = new System.Drawing.Size(120, 21);
            this.textBoxFeeCheck.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxFeeCheck.TabIndex = 35;
            this.textBoxFeeCheck.Visible = false;
            // 
            // label20
            // 
            this.label20.Location = new System.Drawing.Point(205, 125);
            this.label20.Name = "label20";
            this.label20.Size = new System.Drawing.Size(54, 11);
            this.label20.TabIndex = 34;
            this.label20.Text = "检 查 费";
            this.label20.Visible = false;
            // 
            // textBoxFeeRegist
            // 
            this.textBoxFeeRegist.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxFeeRegist.IsEnter2Tab = false;
            this.textBoxFeeRegist.Location = new System.Drawing.Point(67, 121);
            this.textBoxFeeRegist.Name = "textBoxFeeRegist";
            this.textBoxFeeRegist.ReadOnly = true;
            this.textBoxFeeRegist.Size = new System.Drawing.Size(120, 21);
            this.textBoxFeeRegist.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxFeeRegist.TabIndex = 33;
            this.textBoxFeeRegist.Visible = false;
            // 
            // label19
            // 
            this.label19.Location = new System.Drawing.Point(11, 125);
            this.label19.Name = "label19";
            this.label19.Size = new System.Drawing.Size(54, 11);
            this.label19.TabIndex = 32;
            this.label19.Text = "挂 号 费";
            this.label19.Visible = false;
            // 
            // textBoxRegisteInvoice
            // 
            this.textBoxRegisteInvoice.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxRegisteInvoice.IsEnter2Tab = false;
            this.textBoxRegisteInvoice.Location = new System.Drawing.Point(646, 93);
            this.textBoxRegisteInvoice.Name = "textBoxRegisteInvoice";
            this.textBoxRegisteInvoice.ReadOnly = true;
            this.textBoxRegisteInvoice.Size = new System.Drawing.Size(120, 21);
            this.textBoxRegisteInvoice.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxRegisteInvoice.TabIndex = 31;
            // 
            // label18
            // 
            this.label18.Location = new System.Drawing.Point(591, 97);
            this.label18.Name = "label18";
            this.label18.Size = new System.Drawing.Size(54, 11);
            this.label18.TabIndex = 30;
            this.label18.Text = "挂号发票";
            // 
            // textBoxSeeDoctor
            // 
            this.textBoxSeeDoctor.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxSeeDoctor.IsEnter2Tab = false;
            this.textBoxSeeDoctor.Location = new System.Drawing.Point(453, 93);
            this.textBoxSeeDoctor.Name = "textBoxSeeDoctor";
            this.textBoxSeeDoctor.ReadOnly = true;
            this.textBoxSeeDoctor.Size = new System.Drawing.Size(120, 21);
            this.textBoxSeeDoctor.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxSeeDoctor.TabIndex = 29;
            // 
            // label17
            // 
            this.label17.Location = new System.Drawing.Point(398, 97);
            this.label17.Name = "label17";
            this.label17.Size = new System.Drawing.Size(54, 11);
            this.label17.TabIndex = 28;
            this.label17.Text = "看诊医生";
            // 
            // textBoxSeeDepartment
            // 
            this.textBoxSeeDepartment.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxSeeDepartment.IsEnter2Tab = false;
            this.textBoxSeeDepartment.Location = new System.Drawing.Point(260, 93);
            this.textBoxSeeDepartment.Name = "textBoxSeeDepartment";
            this.textBoxSeeDepartment.ReadOnly = true;
            this.textBoxSeeDepartment.Size = new System.Drawing.Size(120, 21);
            this.textBoxSeeDepartment.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxSeeDepartment.TabIndex = 27;
            // 
            // label16
            // 
            this.label16.Location = new System.Drawing.Point(205, 97);
            this.label16.Name = "label16";
            this.label16.Size = new System.Drawing.Size(54, 11);
            this.label16.TabIndex = 26;
            this.label16.Text = "看诊科室";
            // 
            // textBoxRegistDoctor
            // 
            this.textBoxRegistDoctor.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxRegistDoctor.IsEnter2Tab = false;
            this.textBoxRegistDoctor.Location = new System.Drawing.Point(67, 93);
            this.textBoxRegistDoctor.Name = "textBoxRegistDoctor";
            this.textBoxRegistDoctor.ReadOnly = true;
            this.textBoxRegistDoctor.Size = new System.Drawing.Size(120, 21);
            this.textBoxRegistDoctor.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxRegistDoctor.TabIndex = 25;
            // 
            // label15
            // 
            this.label15.Location = new System.Drawing.Point(11, 97);
            this.label15.Name = "label15";
            this.label15.Size = new System.Drawing.Size(54, 11);
            this.label15.TabIndex = 24;
            this.label15.Text = "挂号医生";
            // 
            // textBoxRegistDepartment
            // 
            this.textBoxRegistDepartment.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxRegistDepartment.IsEnter2Tab = false;
            this.textBoxRegistDepartment.Location = new System.Drawing.Point(646, 65);
            this.textBoxRegistDepartment.Name = "textBoxRegistDepartment";
            this.textBoxRegistDepartment.ReadOnly = true;
            this.textBoxRegistDepartment.Size = new System.Drawing.Size(120, 21);
            this.textBoxRegistDepartment.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxRegistDepartment.TabIndex = 23;
            // 
            // label14
            // 
            this.label14.Location = new System.Drawing.Point(591, 70);
            this.label14.Name = "label14";
            this.label14.Size = new System.Drawing.Size(54, 11);
            this.label14.TabIndex = 22;
            this.label14.Text = "挂号科室";
            // 
            // textBoxRegistLevel
            // 
            this.textBoxRegistLevel.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxRegistLevel.IsEnter2Tab = false;
            this.textBoxRegistLevel.Location = new System.Drawing.Point(453, 65);
            this.textBoxRegistLevel.Name = "textBoxRegistLevel";
            this.textBoxRegistLevel.ReadOnly = true;
            this.textBoxRegistLevel.Size = new System.Drawing.Size(120, 21);
            this.textBoxRegistLevel.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxRegistLevel.TabIndex = 21;
            // 
            // label13
            // 
            this.label13.Location = new System.Drawing.Point(399, 70);
            this.label13.Name = "label13";
            this.label13.Size = new System.Drawing.Size(54, 11);
            this.label13.TabIndex = 20;
            this.label13.Text = "挂号级别";
            // 
            // textBoxMCardCode
            // 
            this.textBoxMCardCode.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxMCardCode.IsEnter2Tab = false;
            this.textBoxMCardCode.Location = new System.Drawing.Point(260, 65);
            this.textBoxMCardCode.Name = "textBoxMCardCode";
            this.textBoxMCardCode.ReadOnly = true;
            this.textBoxMCardCode.Size = new System.Drawing.Size(120, 21);
            this.textBoxMCardCode.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxMCardCode.TabIndex = 19;
            // 
            // label12
            // 
            this.label12.Location = new System.Drawing.Point(205, 70);
            this.label12.Name = "label12";
            this.label12.Size = new System.Drawing.Size(54, 11);
            this.label12.TabIndex = 18;
            this.label12.Text = "医疗证号";
            // 
            // textBoxPactName
            // 
            this.textBoxPactName.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxPactName.IsEnter2Tab = false;
            this.textBoxPactName.Location = new System.Drawing.Point(67, 65);
            this.textBoxPactName.Name = "textBoxPactName";
            this.textBoxPactName.ReadOnly = true;
            this.textBoxPactName.Size = new System.Drawing.Size(120, 21);
            this.textBoxPactName.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxPactName.TabIndex = 17;
            // 
            // label11
            // 
            this.label11.Location = new System.Drawing.Point(11, 70);
            this.label11.Name = "label11";
            this.label11.Size = new System.Drawing.Size(54, 11);
            this.label11.TabIndex = 16;
            this.label11.Text = "合同单位";
            // 
            // textBoxBalanceType
            // 
            this.textBoxBalanceType.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxBalanceType.IsEnter2Tab = false;
            this.textBoxBalanceType.Location = new System.Drawing.Point(646, 37);
            this.textBoxBalanceType.Name = "textBoxBalanceType";
            this.textBoxBalanceType.ReadOnly = true;
            this.textBoxBalanceType.Size = new System.Drawing.Size(120, 21);
            this.textBoxBalanceType.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxBalanceType.TabIndex = 15;
            // 
            // label10
            // 
            this.label10.Location = new System.Drawing.Point(591, 41);
            this.label10.Name = "label10";
            this.label10.Size = new System.Drawing.Size(54, 11);
            this.label10.TabIndex = 14;
            this.label10.Text = "结算类别";
            // 
            // textBoxBornDate
            // 
            this.textBoxBornDate.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxBornDate.IsEnter2Tab = false;
            this.textBoxBornDate.Location = new System.Drawing.Point(453, 37);
            this.textBoxBornDate.Name = "textBoxBornDate";
            this.textBoxBornDate.ReadOnly = true;
            this.textBoxBornDate.Size = new System.Drawing.Size(120, 21);
            this.textBoxBornDate.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxBornDate.TabIndex = 13;
            // 
            // label9
            // 
            this.label9.Location = new System.Drawing.Point(399, 41);
            this.label9.Name = "label9";
            this.label9.Size = new System.Drawing.Size(54, 11);
            this.label9.TabIndex = 12;
            this.label9.Text = "出生日期";
            // 
            // textBoxIDCard
            // 
            this.textBoxIDCard.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxIDCard.IsEnter2Tab = false;
            this.textBoxIDCard.Location = new System.Drawing.Point(260, 37);
            this.textBoxIDCard.Name = "textBoxIDCard";
            this.textBoxIDCard.ReadOnly = true;
            this.textBoxIDCard.Size = new System.Drawing.Size(120, 21);
            this.textBoxIDCard.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxIDCard.TabIndex = 11;
            // 
            // label8
            // 
            this.label8.Location = new System.Drawing.Point(206, 41);
            this.label8.Name = "label8";
            this.label8.Size = new System.Drawing.Size(54, 11);
            this.label8.TabIndex = 10;
            this.label8.Text = "身份证号";
            // 
            // textBoxRegisteDate
            // 
            this.textBoxRegisteDate.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxRegisteDate.IsEnter2Tab = false;
            this.textBoxRegisteDate.Location = new System.Drawing.Point(67, 37);
            this.textBoxRegisteDate.Name = "textBoxRegisteDate";
            this.textBoxRegisteDate.ReadOnly = true;
            this.textBoxRegisteDate.Size = new System.Drawing.Size(120, 21);
            this.textBoxRegisteDate.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxRegisteDate.TabIndex = 9;
            // 
            // label7
            // 
            this.label7.Location = new System.Drawing.Point(11, 41);
            this.label7.Name = "label7";
            this.label7.Size = new System.Drawing.Size(54, 11);
            this.label7.TabIndex = 8;
            this.label7.Text = "挂号日期";
            // 
            // textBoxAgeAndSex
            // 
            this.textBoxAgeAndSex.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxAgeAndSex.IsEnter2Tab = false;
            this.textBoxAgeAndSex.Location = new System.Drawing.Point(646, 10);
            this.textBoxAgeAndSex.Name = "textBoxAgeAndSex";
            this.textBoxAgeAndSex.ReadOnly = true;
            this.textBoxAgeAndSex.Size = new System.Drawing.Size(120, 21);
            this.textBoxAgeAndSex.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxAgeAndSex.TabIndex = 7;
            // 
            // label6
            // 
            this.label6.Location = new System.Drawing.Point(591, 13);
            this.label6.Name = "label6";
            this.label6.Size = new System.Drawing.Size(54, 11);
            this.label6.TabIndex = 6;
            this.label6.Text = "性别年龄";
            // 
            // textBoxPatientName
            // 
            this.textBoxPatientName.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxPatientName.IsEnter2Tab = false;
            this.textBoxPatientName.Location = new System.Drawing.Point(453, 10);
            this.textBoxPatientName.Name = "textBoxPatientName";
            this.textBoxPatientName.ReadOnly = true;
            this.textBoxPatientName.Size = new System.Drawing.Size(120, 21);
            this.textBoxPatientName.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxPatientName.TabIndex = 5;
            // 
            // label5
            // 
            this.label5.Location = new System.Drawing.Point(399, 13);
            this.label5.Name = "label5";
            this.label5.Size = new System.Drawing.Size(54, 11);
            this.label5.TabIndex = 4;
            this.label5.Text = "患者姓名";
            // 
            // textBoxClinicCode
            // 
            this.textBoxClinicCode.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxClinicCode.IsEnter2Tab = false;
            this.textBoxClinicCode.Location = new System.Drawing.Point(260, 9);
            this.textBoxClinicCode.Name = "textBoxClinicCode";
            this.textBoxClinicCode.ReadOnly = true;
            this.textBoxClinicCode.Size = new System.Drawing.Size(120, 21);
            this.textBoxClinicCode.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxClinicCode.TabIndex = 3;
            // 
            // label4
            // 
            this.label4.Location = new System.Drawing.Point(193, 13);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(66, 11);
            this.label4.TabIndex = 2;
            this.label4.Text = "门诊流水号";
            // 
            // textBoxCardCode
            // 
            this.textBoxCardCode.BackColor = System.Drawing.Color.WhiteSmoke;
            this.textBoxCardCode.IsEnter2Tab = false;
            this.textBoxCardCode.Location = new System.Drawing.Point(67, 9);
            this.textBoxCardCode.Name = "textBoxCardCode";
            this.textBoxCardCode.ReadOnly = true;
            this.textBoxCardCode.Size = new System.Drawing.Size(120, 21);
            this.textBoxCardCode.Style = Neusoft.FrameWork.WinForms.Controls.StyleType.Fixed3D;
            this.textBoxCardCode.TabIndex = 1;
            // 
            // label3
            // 
            this.label3.Location = new System.Drawing.Point(11, 13);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(54, 11);
            this.label3.TabIndex = 0;
            this.label3.Text = "病历号码";
            // 
            // panelRegistCondition
            // 
            this.panelRegistCondition.Controls.Add(this.textBoxPatientCondition);
            this.panelRegistCondition.Controls.Add(this.label2);
            this.panelRegistCondition.Controls.Add(this.dateTimePickerRegisteTo);
            this.panelRegistCondition.Controls.Add(this.dateTimePickerRegisteFrom);
            this.panelRegistCondition.Controls.Add(this.checkBoxRegisteDate);
            this.panelRegistCondition.Controls.Add(this.label1);
            this.panelRegistCondition.Controls.Add(this.comboBoxOperate);
            this.panelRegistCondition.Controls.Add(this.comboBoxPatientCondition);
            this.panelRegistCondition.Dock = System.Windows.Forms.DockStyle.Top;
            this.panelRegistCondition.Location = new System.Drawing.Point(0, 0);
            this.panelRegistCondition.Name = "panelRegistCondition";
            this.panelRegistCondition.Size = new System.Drawing.Size(781, 38);
            this.panelRegistCondition.TabIndex = 5;
            // 
            // textBoxPatientCondition
            // 
            this.textBoxPatientCondition.EnterVisiable = false;
            this.textBoxPatientCondition.IsFind = false;
            this.textBoxPatientCondition.ListBoxHeight = 100;
            this.textBoxPatientCondition.ListBoxWidth = 100;
            this.textBoxPatientCondition.Location = new System.Drawing.Point(225, 9);
            this.textBoxPatientCondition.Name = "textBoxPatientCondition";
            this.textBoxPatientCondition.OmitFilter = true;
            this.textBoxPatientCondition.SelectedItem = null;
            this.textBoxPatientCondition.SelectNone = true;
            this.textBoxPatientCondition.ShowID = true;
            this.textBoxPatientCondition.Size = new System.Drawing.Size(135, 21);
            this.textBoxPatientCondition.TabIndex = 0;
            this.textBoxPatientCondition.KeyDown += new System.Windows.Forms.KeyEventHandler(this.textBoxPatientCondition_KeyDown);
            // 
            // label2
            // 
            this.label2.Location = new System.Drawing.Point(609, 12);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(16, 11);
            this.label2.TabIndex = 7;
            this.label2.Text = "至";
            // 
            // dateTimePickerRegisteTo
            // 
            this.dateTimePickerRegisteTo.CustomFormat = "yyyy-MM-dd HH:mm:ss";
            this.dateTimePickerRegisteTo.Format = System.Windows.Forms.DateTimePickerFormat.Custom;
            this.dateTimePickerRegisteTo.Location = new System.Drawing.Point(629, 8);
            this.dateTimePickerRegisteTo.Name = "dateTimePickerRegisteTo";
            this.dateTimePickerRegisteTo.Size = new System.Drawing.Size(140, 21);
            this.dateTimePickerRegisteTo.TabIndex = 6;
            // 
            // dateTimePickerRegisteFrom
            // 
            this.dateTimePickerRegisteFrom.CustomFormat = "yyyy-MM-dd HH:mm:ss";
            this.dateTimePickerRegisteFrom.Format = System.Windows.Forms.DateTimePickerFormat.Custom;
            this.dateTimePickerRegisteFrom.Location = new System.Drawing.Point(464, 9);
            this.dateTimePickerRegisteFrom.Name = "dateTimePickerRegisteFrom";
            this.dateTimePickerRegisteFrom.Size = new System.Drawing.Size(140, 21);
            this.dateTimePickerRegisteFrom.TabIndex = 5;
            // 
            // checkBoxRegisteDate
            // 
            this.checkBoxRegisteDate.Checked = true;
            this.checkBoxRegisteDate.CheckState = System.Windows.Forms.CheckState.Checked;
            this.checkBoxRegisteDate.Location = new System.Drawing.Point(366, 12);
            this.checkBoxRegisteDate.Name = "checkBoxRegisteDate";
            this.checkBoxRegisteDate.Size = new System.Drawing.Size(104, 19);
            this.checkBoxRegisteDate.TabIndex = 4;
            this.checkBoxRegisteDate.Text = "挂号时间限制";
            this.checkBoxRegisteDate.CheckedChanged += new System.EventHandler(this.checkBoxRegisteDate_CheckedChanged);
            // 
            // label1
            // 
            this.label1.Location = new System.Drawing.Point(11, 12);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(54, 12);
            this.label1.TabIndex = 3;
            this.label1.Text = "查询条件";
            // 
            // comboBoxOperate
            // 
            this.comboBoxOperate.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.comboBoxOperate.Items.AddRange(new object[] {
            "等于",
            "相似"});
            this.comboBoxOperate.Location = new System.Drawing.Point(163, 9);
            this.comboBoxOperate.Name = "comboBoxOperate";
            this.comboBoxOperate.Size = new System.Drawing.Size(58, 20);
            this.comboBoxOperate.TabIndex = 1;
            this.comboBoxOperate.SelectedIndexChanged += new System.EventHandler(this.comboBoxOperate_SelectedIndexChanged);
            this.comboBoxOperate.KeyDown += new System.Windows.Forms.KeyEventHandler(this.comboBoxOperate_KeyDown);
            // 
            // comboBoxPatientCondition
            // 
            this.comboBoxPatientCondition.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.comboBoxPatientCondition.Items.AddRange(new object[] {
            "病历号码",
            "患者姓名",
            "合同单位",
            "挂号科室",
            "开方医生",
            "医疗证号",
            "发票号码"});
            this.comboBoxPatientCondition.Location = new System.Drawing.Point(67, 9);
            this.comboBoxPatientCondition.Name = "comboBoxPatientCondition";
            this.comboBoxPatientCondition.Size = new System.Drawing.Size(92, 20);
            this.comboBoxPatientCondition.TabIndex = 3;
            this.comboBoxPatientCondition.SelectedIndexChanged += new System.EventHandler(this.comboBoxPatientCondition_SelectedIndexChanged);
            this.comboBoxPatientCondition.KeyDown += new System.Windows.Forms.KeyEventHandler(this.comboBoxPatientCondition_KeyDown);
            // 
            // tabPagePatientInfo
            // 
            this.tabPagePatientInfo.Controls.Add(this.ucRegPatientInfo1);
            this.tabPagePatientInfo.Location = new System.Drawing.Point(4, 22);
            this.tabPagePatientInfo.Name = "tabPagePatientInfo";
            this.tabPagePatientInfo.Size = new System.Drawing.Size(781, 395);
            this.tabPagePatientInfo.TabIndex = 3;
            this.tabPagePatientInfo.Text = "患者基本信息查询";
            this.tabPagePatientInfo.UseVisualStyleBackColor = true;
            // 
            // ucRegPatientInfo1
            // 
            this.ucRegPatientInfo1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(241)))), ((int)(((byte)(247)))), ((int)(((byte)(213)))));
            this.ucRegPatientInfo1.CardNO = "";
            this.ucRegPatientInfo1.CardWay = false;
            this.ucRegPatientInfo1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ucRegPatientInfo1.Enabled = false;
            this.ucRegPatientInfo1.IsEnableEntry = true;
            this.ucRegPatientInfo1.IsEnableIDENO = true;
            this.ucRegPatientInfo1.IsEnableIDEType = true;
            this.ucRegPatientInfo1.IsEnablePact = true;
            this.ucRegPatientInfo1.IsEnableSiNO = true;
            this.ucRegPatientInfo1.IsEnableVip = true;
            this.ucRegPatientInfo1.IsInputBirthDay = false;
            this.ucRegPatientInfo1.IsInputIDENO = false;
            this.ucRegPatientInfo1.IsInputIDEType = false;
            this.ucRegPatientInfo1.IsInputName = true;
            this.ucRegPatientInfo1.IsInputPact = false;
            this.ucRegPatientInfo1.IsInputSex = false;
            this.ucRegPatientInfo1.IsInputSiNo = false;
            this.ucRegPatientInfo1.IsLocalOperation = true;
            this.ucRegPatientInfo1.IsMustInputTabIndex = false;
            this.ucRegPatientInfo1.IsPrint = false;
            this.ucRegPatientInfo1.IsShowTitle = false;
            this.ucRegPatientInfo1.IsTreatment = false;
            this.ucRegPatientInfo1.Location = new System.Drawing.Point(0, 0);
            this.ucRegPatientInfo1.McardNO = "";
            this.ucRegPatientInfo1.Name = "ucRegPatientInfo1";
            this.ucRegPatientInfo1.Size = new System.Drawing.Size(781, 395);
            this.ucRegPatientInfo1.TabIndex = 0;
            // 
            // tabPageInvoiceQuery
            // 
            this.tabPageInvoiceQuery.Controls.Add(this.fpSpreadFeeDetail);
            this.tabPageInvoiceQuery.Location = new System.Drawing.Point(4, 22);
            this.tabPageInvoiceQuery.Name = "tabPageInvoiceQuery";
            this.tabPageInvoiceQuery.Size = new System.Drawing.Size(781, 395);
            this.tabPageInvoiceQuery.TabIndex = 1;
            this.tabPageInvoiceQuery.Text = "发票信息查询";
            this.tabPageInvoiceQuery.UseVisualStyleBackColor = true;
            // 
            // fpSpreadFeeDetail
            // 
            this.fpSpreadFeeDetail.About = "3.0.2004.2005";
            this.fpSpreadFeeDetail.AccessibleDescription = "fpSpreadFeeDetail, Sheet1, Row 0, Column 0, ";
            this.fpSpreadFeeDetail.BackColor = System.Drawing.Color.Transparent;
            this.fpSpreadFeeDetail.Dock = System.Windows.Forms.DockStyle.Fill;
            this.fpSpreadFeeDetail.Location = new System.Drawing.Point(0, 0);
            this.fpSpreadFeeDetail.Name = "fpSpreadFeeDetail";
            this.fpSpreadFeeDetail.Sheets.AddRange(new FarPoint.Win.Spread.SheetView[] {
            this.SheetFeeDetail});
            this.fpSpreadFeeDetail.Size = new System.Drawing.Size(781, 395);
            this.fpSpreadFeeDetail.TabIndex = 0;
            tipAppearance4.BackColor = System.Drawing.SystemColors.Info;
            tipAppearance4.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            tipAppearance4.ForeColor = System.Drawing.SystemColors.InfoText;
            this.fpSpreadFeeDetail.TextTipAppearance = tipAppearance4;
            // 
            // SheetFeeDetail
            // 
            this.SheetFeeDetail.Reset();
            this.SheetFeeDetail.SheetName = "Sheet1";
            // Formulas and custom names must be loaded with R1C1 reference style
            this.SheetFeeDetail.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.R1C1;
            this.SheetFeeDetail.ColumnCount = 504;
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 0).Value = "发票号码";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 1).Value = "划价收费";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 2).Value = "状态";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 3).Value = "录入来源";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 4).Value = "项目编码";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 5).Value = "项目名称";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 6).Value = "组";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 7).Value = "组名";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 8).Value = "内部序号";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 9).Value = "序列号";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 10).Value = "规格";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 11).Value = "数量";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 12).Value = "单价";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 13).Value = "总金额";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 14).Value = "自付金额";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 15).Value = "记帐金额";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 16).Value = "开单科室";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 17).Value = "开单医生";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 18).Value = "录入人";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 19).Value = "录入时间";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 20).Value = "执行科室";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 21).Value = "收款员";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 22).Value = "收费日期";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 23).Value = "确认执行时间";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 24).Value = "确认执行科室";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 25).Value = "确认执行人";
            this.SheetFeeDetail.ColumnHeader.Cells.Get(0, 26).Value = "确认执行时间";
            this.SheetFeeDetail.Columns.Get(0).Label = "发票号码";
            this.SheetFeeDetail.Columns.Get(0).Width = 100F;
            this.SheetFeeDetail.Columns.Get(2).Label = "状态";
            this.SheetFeeDetail.Columns.Get(2).Width = 40F;
            this.SheetFeeDetail.Columns.Get(4).Label = "项目编码";
            this.SheetFeeDetail.Columns.Get(4).Width = 100F;
            this.SheetFeeDetail.Columns.Get(5).Label = "项目名称";
            this.SheetFeeDetail.Columns.Get(5).Width = 100F;
            this.SheetFeeDetail.Columns.Get(6).Label = "组";
            this.SheetFeeDetail.Columns.Get(6).Width = 25F;
            this.SheetFeeDetail.Columns.Get(7).Label = "组名";
            this.SheetFeeDetail.Columns.Get(7).Width = 69F;
            this.SheetFeeDetail.Columns.Get(18).Label = "录入人";
            this.SheetFeeDetail.Columns.Get(18).Width = 100F;
            this.SheetFeeDetail.Columns.Get(23).Label = "确认执行时间";
            this.SheetFeeDetail.Columns.Get(23).Width = 100F;
            this.SheetFeeDetail.DataAutoSizeColumns = false;
            this.SheetFeeDetail.OperationMode = FarPoint.Win.Spread.OperationMode.SingleSelect;
            this.SheetFeeDetail.RowHeader.Columns.Default.Resizable = false;
            this.SheetFeeDetail.SelectionPolicy = FarPoint.Win.Spread.Model.SelectionPolicy.Single;
            this.SheetFeeDetail.SelectionUnit = FarPoint.Win.Spread.Model.SelectionUnit.Row;
            this.SheetFeeDetail.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.A1;
            // 
            // tabPageOrderQuery
            // 
            this.tabPageOrderQuery.Controls.Add(this.ucOrderHistory1);
            this.tabPageOrderQuery.Location = new System.Drawing.Point(4, 22);
            this.tabPageOrderQuery.Name = "tabPageOrderQuery";
            this.tabPageOrderQuery.Size = new System.Drawing.Size(781, 395);
            this.tabPageOrderQuery.TabIndex = 2;
            this.tabPageOrderQuery.Text = "医嘱信息查询";
            this.tabPageOrderQuery.UseVisualStyleBackColor = true;
            // 
            // ucOrderHistory1
            // 
            this.ucOrderHistory1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(241)))), ((int)(((byte)(247)))), ((int)(((byte)(213)))));
            this.ucOrderHistory1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ucOrderHistory1.IsPrint = false;
            this.ucOrderHistory1.Location = new System.Drawing.Point(0, 0);
            this.ucOrderHistory1.Name = "ucOrderHistory1";
            this.ucOrderHistory1.Size = new System.Drawing.Size(781, 395);
            this.ucOrderHistory1.TabIndex = 0;
            // 
            // ucClinicQuery
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.Controls.Add(this.tabControl1);
            this.Name = "ucClinicQuery";
            this.Size = new System.Drawing.Size(789, 421);
            this.Load += new System.EventHandler(this.frmClinicQuery_Load);
            this.tabControl1.ResumeLayout(false);
            this.tabPageRegisteQuery.ResumeLayout(false);
            this.panelRegistRecord.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.fpSpreadRegistRecord)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.SheetRegistRecord)).EndInit();
            this.panelRegister.ResumeLayout(false);
            this.panelRegister.PerformLayout();
            this.panelRegistCondition.ResumeLayout(false);
            this.panelRegistCondition.PerformLayout();
            this.tabPagePatientInfo.ResumeLayout(false);
            this.tabPageInvoiceQuery.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.fpSpreadFeeDetail)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.SheetFeeDetail)).EndInit();
            this.tabPageOrderQuery.ResumeLayout(false);
            this.ResumeLayout(false);

		}

		#endregion

		#endregion

		//
		// 变量
		//
		#region 变量

		#region 枚举
		/// <summary>
		/// 查询方式枚举
		/// </summary>
		enum QueryType
		{
			CardCode = 0,
			PatientName = 1,
			PactCode = 2,
			SeeDepartment = 3,
			SeeDoctor = 4,
			MedicareCode = 5,
			InvoiceCode = 6
		}
		/// <summary>
		/// 查询操作方式枚举
		/// </summary>
		enum OperateType
		{
			EqueQuery = 0,
			LikeQuery = 1
		}
		/// <summary>
		/// 挂号FarPoint字段枚举
		/// </summary>
		enum RegisterField
		{
			/// <summary>
			/// 病历号0
			/// </summary>
			CardCode = 0,
			/// <summary>
			/// 患者姓名1
			/// </summary>
			PatientName = 1,
			/// <summary>
			/// 挂号日期2
			/// </summary>
			RegisteDate = 2,
			/// <summary>
			/// 结算类别3
			/// </summary>
			PayKindName = 3,
			/// <summary>
			/// 合同单位4
			/// </summary>
			PactName = 4,
			/// <summary>
			/// 挂号级别5
			/// </summary>
			RegisteLevel = 5,
			/// <summary>
			/// 挂号科室6
			/// </summary>
			RegisteDepartment = 6,
            /// <summary>
            /// 挂号医生
            /// </summary>
            RegisterDoctor = 7,
            /// <summary>
            /// 看诊序号
            /// </summary>
            SeeNo = 8,
            /// <summary>
            /// 是否有效
            /// </summary>
            Valid = 9,
            /// <summary>
            /// 退号时间
            /// </summary>
            CancelDate = 10,
            /// <summary>
            /// 是否已看诊
            /// </summary>
            YnSee = 11,
		}
		enum FeeDetail
		{
			/// <summary>
			/// 发票号码0
			/// </summary>
			InvoiceCode = 0,
			/// <summary>
			/// 划价收费状态1
			/// </summary>
			ChargeState = 1,
			/// <summary>
			/// 状态2
			/// </summary>
			State = 2,
			/// <summary>
			/// 项目编码3
			/// </summary>
			ItemCode = 3,
			/// <summary>
			/// 项目名称4
			/// </summary>
			ItemName = 4,
			/// <summary>
			/// 项目数量5
			/// </summary>
			ItemCount = 5,
			/// <summary>
			/// 项目单价6
			/// </summary>
			ItemPrice = 6,
			/// <summary>
			/// 总金额7
			/// </summary>
			TotalCost = 7,
			/// <summary>
			/// 自付金额8
			/// </summary>
			OwnCost = 8,
			/// <summary>
			/// 记帐金额9
			/// </summary>
			PubCost = 9,
			/// <summary>
			/// 开单科室10
			/// </summary>
			CreateDepartment = 10,
			/// <summary>
			/// 开单医生11
			/// </summary>
			CreateDoctor = 11,

            /// <summary>
            /// 执行科室[划价\收费时确定]
            /// </summary>
            EXEDPCD = 12,

			/// <summary>
			/// 收款员12
			/// </summary>
			ChargeEmployee = 13,
			/// <summary>
			/// 收款日期13
			/// </summary>
			ChargeDate = 14,
			/// <summary>
			/// 确认执行状态14
			/// </summary>
			ExecuteState = 15,
			/// <summary>
			/// 确认执行科室15
			/// </summary>
			ExecuteDepartment = 16,
			/// <summary>
			/// 确认执行人16
			/// </summary>
			ExecuteEmployee = 17,
			/// <summary>
			/// 确认执行时间17
			/// </summary>
			ExecuteDate = 18
		}
		#endregion 

		/// <summary>
		/// 是否选择了挂号时间限制
		/// </summary>
		bool boolRegisteDate = true;
		/// <summary>
		/// 返回值
		/// </summary>
		int intReturn = 0;
		/// <summary>
		/// 当前挂号信息
		/// </summary>
        Neusoft.HISFC.Models.Registration.Register register = new Neusoft.HISFC.Models.Registration.Register();
		/// <summary>
		/// 查询方式
		/// </summary>
		QueryType enumQuery = QueryType.CardCode;
		/// <summary>
		/// 查询操作方式
		/// </summary>
		OperateType enumOperate = OperateType.LikeQuery;
		/// <summary>
		/// 方法类
		/// </summary>
        OutpatientFee.Class.OutPatientQuery function = new Neusoft.WinForms.Report.OutpatientFee.Class.OutPatientQuery();
		/// <summary>
		/// 科室业务层
		/// </summary>
        Neusoft.HISFC.BizLogic.Manager.Department departmentFunction = new Neusoft.HISFC.BizLogic.Manager.Department();
		/// <summary>
		/// 合同单位数组
		/// </summary>
		ArrayList alPact = new ArrayList();
		/// <summary>
		/// 科室数组
		/// </summary>
		ArrayList alDepartment = new ArrayList() ;
		/// <summary>
		/// 医生数组
		/// </summary>
		ArrayList alEmployee = new ArrayList();

        ////{E26C3EE9-D480-421e-9FD3-7094D8E4E1D0}
        Neusoft.FrameWork.Public.ObjectHelper deptHelper = new Neusoft.FrameWork.Public.ObjectHelper();

        Neusoft.FrameWork.Public.ObjectHelper emplHelper = new Neusoft.FrameWork.Public.ObjectHelper();
		/// <summary>
		/// 选择窗口
		/// </summary>
		//Neusoft.Common.Forms.frmEasyChoose frmChoose;
		#endregion

		//
		// 属性
		//
		#region 属性
		#region 当前挂号信息
		/// <summary>
		/// 当前挂号信息
		/// </summary>
		public Neusoft.HISFC.Models.Registration.Register Register
		{
			get
			{
				return this.register;
			}
			set
			{
				this.register = value;
				// 病历号码
				this.textBoxCardCode.Text = this.register.PID.CardNO;
				// 门诊号
                this.textBoxClinicCode.Text = this.register.ID;
				// 姓名
				this.textBoxPatientName.Text = this.register.Name;
				// 性别/年龄
				this.textBoxAgeAndSex.Text = this.register.Sex.Name + "|" + departmentFunction.GetAge(this.register.Birthday);
				// 挂号日期
				this.textBoxRegisteDate.Text = this.register.DoctorInfo.SeeDate.ToString();
				// 身份证号
				this.textBoxIDCard.Text = this.register.IDCard;
				// 出生日期
				this.textBoxBornDate.Text = this.register.Birthday.Date.ToString();
				// 结算类别: 01-自费  02-保险 03-公费在职 04-公费退休 05-公费高干
				switch (this.register.Pact.PayKind.ID)
				{
					case "01":
						this.textBoxBalanceType.Text = "自费";
						break;
					case "02":
						this.textBoxBalanceType.Text = "医保";
						break;
					case "03":
						this.textBoxBalanceType.Text = "公费";
						break;
				}
				// 合同单位
				this.textBoxPactName.Text = this.register.Pact.Name;
				// 医疗证号
				this.textBoxMCardCode.Text = this.register.SSN;
				// 挂号级别
				this.textBoxRegistLevel.Text = this.register.DoctorInfo.Templet.RegLevel.Name;
				// 挂号科室
				this.textBoxRegistDepartment.Text = this.register.DoctorInfo.Templet.Dept.Name;
				// 挂号医生
				this.textBoxRegistDoctor.Text = this.register.DoctorInfo.Templet.Doct.Name;
				// 看诊科室
                //{E26C3EE9-D480-421e-9FD3-7094D8E4E1D0}
                //this.textBoxSeeDepartment.Text = this.register.DoctorInfo.Templet.Dept.Name;
         
                //this.textBoxSeeDoctor.Text = this.register.DoctorReceiver.Name;
                this.textBoxSeeDepartment.Text = this.deptHelper.GetName(this.register.SeeDPCD);

                this.textBoxSeeDoctor.Text = this.emplHelper.GetName(this.register.SeeDOCD);

				// 挂号发票
				this.textBoxRegisteInvoice.Text = this.register.InvoiceNO;
				// 挂号费
				this.textBoxFeeRegist.Text = this.register.RegLvlFee.RegFee.ToString();
				// 检查费
				this.textBoxFeeCheck.Text = this.register.RegLvlFee.ChkFee.ToString();
				// 诊察费
				this.textBoxFeeDiagnose.Text = this.register.RegLvlFee.OwnDigFee.ToString();
				// 附加费
				this.textBoxFeeOther.Text = this.register.RegLvlFee.OthFee.ToString();
			}
		}
		#endregion
		#endregion

		//
		// 事件
		//
		#region 窗口加载事件
		/// <summary>
		/// 窗口加载事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void frmClinicQuery_Load(object sender, System.EventArgs e)
		{
			// 科室业务层
			Neusoft.HISFC.BizProcess.Integrate.Manager manager = new Neusoft.HISFC.BizProcess.Integrate.Manager();
			// 医生业务层
            Neusoft.HISFC.BizLogic.Manager.UserManager userFunction = new Neusoft.HISFC.BizLogic.Manager.UserManager();
			// 常数业务层
            Neusoft.HISFC.BizLogic.Manager.Constant constFunction = new Neusoft.HISFC.BizLogic.Manager.Constant();

			Neusoft.FrameWork.WinForms.Classes.Function.ShowWaitForm("正在初始化信息...");
            Application.DoEvents();
			// 设置挂号信息FarPoint页自动排序
			this.SheetRegistRecord.SetColumnAllowAutoSort(-1,true);
			// 设置费用信息FarPoint页自动排序
			this.SheetFeeDetail.SetColumnAllowAutoSort(-1,true);

			// 初始化科室
            this.alDepartment = manager.QueryRegDepartment();

            ArrayList alAllDept = manager.GetDepartment();

            ////{E26C3EE9-D480-421e-9FD3-7094D8E4E1D0}
            this.deptHelper.ArrayObject = alAllDept;
			// 初始化医生

            this.alEmployee = manager.QueryEmployee(Neusoft.HISFC.Models.Base.EnumEmployeeType.D);

            ArrayList alAllDoct = manager.QueryEmployeeAll();

            ////{E26C3EE9-D480-421e-9FD3-7094D8E4E1D0}
            this.emplHelper.ArrayObject = alAllDoct;
			// 初始化合同单位
			this.alPact = constFunction.GetAllList("PACTUNIT");

			// 设置起始时间和截止时间
			this.dateTimePickerRegisteTo.Value = departmentFunction.GetDateTimeFromSysDateTime();
			this.dateTimePickerRegisteFrom.Value = new DateTime(this.dateTimePickerRegisteTo.Value.Year,
																this.dateTimePickerRegisteTo.Value.Month,
																this.dateTimePickerRegisteTo.Value.Day,
																0,
																0,
																0);

			// 设置焦点到条件输入框
			this.tabPageRegisteQuery.Focus();
			this.textBoxPatientCondition.Focus();
            this.ucRegPatientInfo1.IsShowTitle = false;
            this.ucRegPatientInfo1.SetControlEnable(false);

			Neusoft.FrameWork.WinForms.Classes.Function.HideWaitForm();
		}
		#endregion

		// 挂号信息
		#region 查询条件选择事件
		/// <summary>
		/// 查询条件选择事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void comboBoxPatientCondition_SelectedIndexChanged(object sender, System.EventArgs e)
		{
            this.Clear();
            // 设置查询方式枚举
			this.enumQuery = (QueryType)this.comboBoxPatientCondition.SelectedIndex;
			// 设置焦点到查询操作方式
			this.comboBoxOperate.Focus();
            // 根据查询方式设置不同的查询效果
            #region  屏蔽 [肿瘤医院]

            switch (this.enumQuery)
            {
                case QueryType.PactCode:
                    // 按合同单位查询,条件输入框只读
                    this.textBoxPatientCondition.ReadOnly = false;
                    this.textBoxPatientCondition.AddItems( this.alPact );
                    break;
                case QueryType.SeeDepartment:
                    // 按挂号科室查询,条件输入框只读
                    this.textBoxPatientCondition.ReadOnly = false;
                    this.textBoxPatientCondition.AddItems( this.alDepartment );
                    break;
                case QueryType.SeeDoctor:
                    // 按开方医生查询,条件输入框只读
                    this.textBoxPatientCondition.ReadOnly = false;
                    this.textBoxPatientCondition.AddItems( this.alEmployee);
                    break;
                default:
                    // 否则条件输入框可写
                    ArrayList al = new ArrayList();
                    this.textBoxPatientCondition.AddItems( al );
                    break;
            }

            #endregion  
		}
		#endregion
		#region 查询条件回车事件
		/// <summary>
		/// 查询条件回车事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void comboBoxPatientCondition_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
		{
			// 如果回车,那么设置焦点到查询方式
			if (e.KeyCode.Equals(Keys.Enter))
			{
				// 设置焦点到查询方式
				this.comboBoxOperate.Focus();
				// 设置查询方式枚举
				this.enumQuery = (QueryType)this.comboBoxPatientCondition.SelectedIndex;
			}
		}
		#endregion

		#region 查询操作方式选择事件
		/// <summary>
		/// 查询操作方式选择事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void comboBoxOperate_SelectedIndexChanged(object sender, System.EventArgs e)
		{
			// 设置焦点到条件输入框
			this.textBoxPatientCondition.Focus();
			// 全选内容
			this.textBoxPatientCondition.SelectAll();
			// 设置查询操作方式
			this.enumOperate = (OperateType)this.comboBoxOperate.SelectedIndex;
			// 清空查询条件输入框
			this.textBoxPatientCondition.Text = "";
		}
		#endregion
		#region 查询操作方式回车事件
		/// <summary>
		/// 查询操作方式回车事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void comboBoxOperate_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
		{
			// 如果回车
			if (e.KeyCode.Equals(Keys.Enter))
			{
				// 那么设置焦点到输入框
				this.textBoxPatientCondition.Focus();
				// 使条件输入框的内容全选
				this.textBoxPatientCondition.SelectAll();
				// 设置查询操作方式
				this.enumOperate = (OperateType)this.comboBoxOperate.SelectedIndex;
			}
		}
		#endregion

		#region 挂号时间复选框选择事件
		/// <summary>
		/// 挂号时间复选框选择事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void checkBoxRegisteDate_CheckedChanged(object sender, System.EventArgs e)
		{
			// 设置是否有挂号时间限制
			this.boolRegisteDate = this.checkBoxRegisteDate.Checked;

			// 设置时间控件的可用性
			if (this.checkBoxRegisteDate.Checked)
			{
				// 如果有时间限制,那么设置两个时间选择控件可用
				this.dateTimePickerRegisteFrom.Enabled = true;
				this.dateTimePickerRegisteTo.Enabled = true;
			}
			else
			{
				// 否则不可用
				this.dateTimePickerRegisteFrom.Enabled = false;
				this.dateTimePickerRegisteTo.Enabled = false;
			}
		}
		#endregion

		#region 查询条件输入框按键事件
		/// <summary>
		/// 查询条件输入框按键事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void textBoxPatientCondition_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
		{
			if (e.KeyCode.Equals(Keys.Enter))
			{
				// 如果会车,那么执行查询
				Neusoft.FrameWork.WinForms.Classes.Function.ShowWaitForm("正在检索信息...");
                Application.DoEvents();
                //先清空原来的挂号信息
                this.Clear();
				// 查询挂号信息
				this.QueryRegister();

				Neusoft.FrameWork.WinForms.Classes.Function.HideWaitForm();
            }
            #region 屏蔽 [肿瘤医院]

            //else if (e.KeyCode.Equals(Keys.Space))
            //{
            //    // 选择的项目
            //    Neusoft.NFC.Object.NeuObject selectObject = new NeuObject();

            //    // 根据查询类别,显示不同的选择窗口
            //    if (this.enumQuery.Equals(QueryType.PactCode))
            //    {
            //        // 合同单位
            //        //frmChoose = new frmEasyChoose(this.alPact);
            //        // 显示选择窗口
            //        //frmChoose.ShowDialog();
            //        this.textBoxPatientCondition.AddItems( this.alPact );
            //    }
            //    else if (this.enumQuery.Equals(QueryType.SeeDepartment))
            //    {
            //        this.textBoxPatientCondition.AddItems( this.alDepartment );
            //        // 科室
            //        //frmChoose = new frmEasyChoose(this.alDepartment) ;
            //        //frmChoose.ShowDialog();
            //    }
            //    else if (this.enumQuery.Equals(QueryType.SeeDoctor))
            //    {
            //        this.textBoxPatientCondition.AddItems(this.alEmployee);
            //        // 员工
            //        //frmChoose = new frmEasyChoose(this.alEmployee);
            //        //frmChoose.ShowDialog();
            //    }

            //    this.Focus();
            //    // 设置焦点到当前条件输入框
            //    this.textBoxPatientCondition.Focus();

            //    // 显示选择结果
            //    //selectObject = frmChoose.Object;
            //    //if (selectObject != null)
            //    //{
            //    //    // 显示选择的项目名称
            //    //    this.textBoxPatientCondition.Text = selectObject.Name;
            //    //    // 保存Tag为对象
            //    //    this.textBoxPatientCondition.Tag = selectObject;
            //    //}
            //}

            #endregion
		}
		#endregion

		#region 挂号信息FarPoint鼠标双击事件

        /// <summary>
        /// 挂号信息Farpoint鼠标单击事件[单击查看患者信息]
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void fpSpreadRegistRecord_CellClick( object sender, FarPoint.Win.Spread.CellClickEventArgs e )
        {
            // 显示挂号信息
            this.Register = (Neusoft.HISFC.Models.Registration.Register)this.GetRowTag( this.SheetRegistRecord, e.Row );

        }

		/// <summary>
		/// 挂号信息FarPoint鼠标双击事件[双击查看明细]
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void fpSpreadRegistRecord_CellDoubleClick(object sender, FarPoint.Win.Spread.CellClickEventArgs e)
		{
			if (this.SheetRegistRecord.RowCount>0)
			{
                this.tabControl1.SelectedTab = tabPageInvoiceQuery;
				Neusoft.FrameWork.WinForms.Classes.Function.ShowWaitForm("正在检索信息...");
                Application.DoEvents();

                (this.ucOrderHistory1 as Neusoft.HISFC.Components.Order.OutPatient.Controls.ucOrderHistory).Patient = this.Register;
                this.ucRegPatientInfo1.Clear();
                this.ucRegPatientInfo1.CardNO = this.Register.PID.CardNO;
				// 费用明细数据集
				System.Data.DataSet dsResult = new DataSet();
				
				// 显示费用明细
				this.intReturn = function.GetFeeDetailByClinicCode(this.Register.ID, ref dsResult);
				if (this.intReturn == -1)
				{
					Neusoft.FrameWork.WinForms.Classes.Function.HideWaitForm();
					MessageBox.Show("获取费用明细失败!\n" + function.Err);
					return;
				}
				// 设置费用数据源为查询结果
				this.SheetFeeDetail.DataSource = dsResult;
                 Neusoft.HISFC.Components.Common.Classes.Function.DrawCombo(this.SheetFeeDetail,6,6);
                foreach (FarPoint.Win.Spread.Column col in this.SheetFeeDetail.Columns)
                {
                    col.Width = col.GetPreferredWidth();
                }
                for (int i = 0; i < this.SheetFeeDetail.Rows.Count; i++)
                {
                    this.SheetFeeDetail.Rows[i].BackColor = Color.White;

                    if (this.SheetFeeDetail.Cells[i,2].Text == "退费")
                    {
                        this.SheetFeeDetail.Rows[i].BackColor = Color.MistyRose;
                    }
                }
                
				Neusoft.FrameWork.WinForms.Classes.Function.HideWaitForm();
                
			}
		}
		#endregion

		#region 工具栏按钮单击事件
		/// <summary>
		/// 工具栏按钮单击事件
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void toolBar1_ButtonClick(object sender, System.Windows.Forms.ToolBarButtonClickEventArgs e)
		{
            //if (e.Button.Equals(this.toolBarButtonQuery))
            //{
            //    // 如果单击了查询按钮,那么执行查询
            //    this.QueryRegister();
            //}
            //else if (e.Button.Equals(this.tbExpert))
            //{
            //    // 如果单击了查询按钮,那么执行查询
            //    this.Export();
            //}
            //else if (e.Button.Equals(this.toolBarButtonExit))
            //{
            //    // 如果单击了退出按钮,那么提示用户是否退出
            //    if (DialogResult.Yes.Equals(MessageBox.Show("退出查询?","门诊收费综合查询",MessageBoxButtons.YesNo,MessageBoxIcon.Question,MessageBoxDefaultButton.Button2)))
            //    {
            //        //this.Close();
            //    }
            //}
		}
		#endregion

		#region 窗口按键事件
		/// <summary>
		/// 窗口按键事件
		/// </summary>
		/// <param name="keyData"></param>
		/// <returns></returns>
		protected override bool ProcessDialogKey(Keys keyData)
		{
			if (keyData.Equals(Keys.F8))
			{
				// 如果按F8,那么执行查询
				this.QueryRegister();
			}
			else if (keyData.Equals(Keys.F9))
			{
				// 如果按F8,那么执行查询
				this.Export();
			}
			else if (keyData.Equals(Keys.F12))
			{
				// 如果F12,那么提示用户是否退出
				if (DialogResult.Yes.Equals(MessageBox.Show("退出查询?","门诊收费综合查询",MessageBoxButtons.YesNo,MessageBoxIcon.Question,MessageBoxDefaultButton.Button2)))
				{
					//this.Close();
				}
			}
			return base.ProcessDialogKey (keyData);
		}
		#endregion

		
		//
		// 函数
		//
        // 挂号信息
        #region 清空挂号信息显示
        /// <summary>
        /// 清空挂号信息的显示
        /// </summary>
        private void Clear()
        {
            // 病历号码
            this.textBoxCardCode.Text = "";
            // 门诊号
            this.textBoxClinicCode.Text = "";
            // 姓名
            this.textBoxPatientName.Text = "";
            // 性别/年龄
            this.textBoxAgeAndSex.Text = "";
            // 挂号日期
            this.textBoxRegisteDate.Text = "";
            // 身份证号
            this.textBoxIDCard.Text = "";
            // 出生日期
            this.textBoxBornDate.Text = "";
            // 结算类别: 01-自费  02-保险 03-公费在职 04-公费退休 05-公费高干
            this.textBoxBalanceType.Text = "";
            // 合同单位
            this.textBoxPactName.Text = "";
            // 医疗证号
            this.textBoxMCardCode.Text = "";
            // 挂号级别
            this.textBoxRegistLevel.Text = "";
            // 挂号科室
            this.textBoxRegistDepartment.Text = "";
            // 挂号医生
            this.textBoxRegistDoctor.Text = "";
            // 看诊科室
            this.textBoxSeeDepartment.Text = "";
            // 看诊医生
            this.textBoxSeeDoctor.Text = "";
            // 挂号发票
            this.textBoxRegisteInvoice.Text = "";
            // 挂号费
            this.textBoxFeeRegist.Text = "";
            // 检查费
            this.textBoxFeeCheck.Text = "";
            // 诊察费
            this.textBoxFeeDiagnose.Text = "";
            // 附加费
            this.textBoxFeeOther.Text = "";
            this.SheetFeeDetail.RowCount = 0;
            this.SheetRegistRecord.RowCount = 0;
            this.ucRegPatientInfo1.Clear();
            this.ucOrderHistory1.Patient = new Neusoft.HISFC.Models.Registration.Register();
        }

        #endregion
        #region 判断条件输入框是否合法
        /// <summary>
		/// 判断条件输入框是否合法
		/// </summary>
		/// <returns>1-合法,-1-不合法</returns>
		private int JudgeInput()
		{
			// 不允许为空
			if (this.textBoxPatientCondition.Text == null || this.textBoxPatientCondition.Text.Equals(""))
			{
				MessageBox.Show("查询条件不允许为空!");
				// 设置焦点到条件输入框
				this.textBoxPatientCondition.Focus();

				return -1;
			}

			// 成功返回
			return 1;
		}
		#endregion

		#region 获取挂号时间限制
		/// <summary>
		/// 获取挂号时间限制
		/// [参数1: ref DateTime dtFrom - 起始时间]
		/// [参数2: ref DateTime dtTo - 截止时间]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="dtFrom">起始时间</param>
		/// <param name="dtTo">截止时间</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetDateLimited(ref DateTime dtFrom, ref DateTime dtTo)
		{
			// 起始时间不能大于截止时间
			if (this.dateTimePickerRegisteFrom.Value > this.dateTimePickerRegisteTo.Value)
			{
				MessageBox.Show("起始时间不能大于截止时间!");
				// 设置焦点到起始时间控件
				this.dateTimePickerRegisteFrom.Focus();
				return -1;
			}

			// 起始时间
			dtFrom = this.dateTimePickerRegisteFrom.Value;
			// 截止时间
			dtTo = this.dateTimePickerRegisteTo.Value;

			// 成功返回
			return 1;
		}
		#endregion

		#region 查询挂号信息
		/// <summary>
		/// 查询挂号信息
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <returns>1-成功,-1-失败</returns>
		private int QueryRegister()
		{
			// 挂号实体
            Neusoft.HISFC.Models.Registration.Register tempRegister = new Neusoft.HISFC.Models.Registration.Register();
			// 返回的挂号实体数组
			ArrayList alRegister = new ArrayList();

			// 判断输入是否合法
			if (this.JudgeInput() == -1)
			{
				return -1;
			}

			// 根据不同的查询方式,设置不同的查询信息,执行不同的查询
			switch (this.enumQuery)
			{
				case QueryType.CardCode:
					// 病历号
                    //tempRegister.PID.CardNO = this.textBoxPatientCondition.Text;

                    //Neusoft.HISFC.Models.Account.AccountCard accountCard = new Neusoft.HISFC.Models.Account.AccountCard();
                    //ReadMarkNO.ReadMarkNO readMarkNoMana = new ReadMarkNO.ReadMarkNO();
                    //if (readMarkNoMana.ReadMarkNOByRule(tempRegister.PID.CardNO, ref accountCard) < 0)
                    //{
                    //    MessageBox.Show(readMarkNoMana.Error);

                    //    return -1;
                    //}

                   
                    //tempRegister.PID.CardNO = accountCard.Patient.PID.CardNO;

                    this.textBoxPatientCondition.Text = this.textBoxPatientCondition.Text.Trim().PadLeft(10, '0');
                    tempRegister.PID.CardNO = this.textBoxPatientCondition.Text;

					// 执行查询
					this.intReturn = this.GetRegisterListByCardCode(tempRegister, alRegister);
                    
					break;
				case QueryType.PatientName:
					// 姓名
					tempRegister.Name = this.textBoxPatientCondition.Text;
					// 执行查询
					this.intReturn = this.GetRegisterListByName(tempRegister, alRegister);
					break;
				case QueryType.PactCode:
					// 合同单位编码
                    if (this.textBoxPatientCondition.Tag == null)
                    {
                        return -1;
                    }
					tempRegister.Pact.ID = this.textBoxPatientCondition.Tag.ToString();
					this.intReturn = this.GetRegisterListByPact(tempRegister, alRegister);
					break;
				case QueryType.SeeDepartment:
					// 挂号科室
                    if (this.textBoxPatientCondition.Tag == null)
                    {
                        return -1;
                    }
					tempRegister.DoctorInfo.Templet.Dept.ID = this.textBoxPatientCondition.Tag.ToString();
					this.intReturn = this.GetRegisterListByDepartment(tempRegister, alRegister);
					break;
				case QueryType.SeeDoctor:
					// 开方医生
                    if (this.textBoxPatientCondition.Tag == null)
                    {
                        return -1;
                    }
					tempRegister.DoctorInfo.Templet.Doct.ID = this.textBoxPatientCondition.Tag.ToString();
					this.intReturn = this.GetRegisterListByDoctor(tempRegister, alRegister);
					break;
				case QueryType.MedicareCode:
					// 医疗证号
					tempRegister.SSN= this.textBoxPatientCondition.Text;
					this.intReturn = this.GetRegisterListByMCard(tempRegister, alRegister);
					break;
				case QueryType.InvoiceCode:
					// 发票号
					tempRegister.Memo = this.textBoxPatientCondition.Text;
					this.intReturn = this.GetRegisterListByInvoice(tempRegister, alRegister);
					break;
			}

			// 判断查询结果查询
			if (this.intReturn == -1)
			{
				return -1;
			}

			// 设置FarPoint
			this.SetRegisterFarPoint(alRegister);

			// 成功返回
			return 1;
		}
		#endregion

		#region 根据病历号获取挂号信息
		/// <summary>
		/// 根据病历号获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有病历号的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有病历号的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByCardCode(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByCardCode(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByCardCode(argRegister, alRegisters, dtFrom, dtTo, false);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByCardCode(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByCardCode(argRegister, alRegisters, false);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion
		#region 根据姓名获取挂号信息
		/// <summary>
		/// 根据病历号获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有姓名的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有姓名的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByName(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByName(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByName(argRegister, alRegisters, dtFrom, dtTo, true);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByName(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByName(argRegister, alRegisters, true);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion
		#region 根据合同单位获取挂号信息
		/// <summary>
		/// 根据合同单位获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有姓名的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有姓名的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByPact(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByPact(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByPact(argRegister, alRegisters, dtFrom, dtTo, true);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByPact(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByPact(argRegister, alRegisters, true);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion
		#region 根据挂号科室获取挂号信息
		/// <summary>
		/// 根据挂号科室获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有姓名的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有姓名的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByDepartment(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByDepartment(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByDepartment(argRegister, alRegisters, dtFrom, dtTo, true);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByDepartment(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByDepartment(argRegister, alRegisters, true);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion
		#region 根据开方医生获取挂号信息
		/// <summary>
		/// 根据开方医生获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有姓名的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有姓名的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByDoctor(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByDoctor(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByDoctor(argRegister, alRegisters, dtFrom, dtTo, true);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByDoctor(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByDoctor(argRegister, alRegisters, true);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion
		#region 根据医疗证号获取挂号信息
		/// <summary>
		/// 根据医疗证号获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有姓名的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有姓名的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByMCard(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByMCard(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByMCard(argRegister, alRegisters, dtFrom, dtTo, true);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByMCard(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByMCard(argRegister, alRegisters, true);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion
		#region 根据发票号获取挂号信息
		/// <summary>
		/// 根据发票号获取挂号信息
		/// [参数1: Neusoft.HISFC.Models.Registration.Register argRegister - 含有姓名的挂号实体]
		/// [参数2: ArrayList alRegisters - 返回的挂号记录]
		/// [返回: int,1-成功,-1-失败]
		/// </summary>
		/// <param name="argRegister">含有姓名的挂号实体</param>
		/// <param name="alRegisters">返回的挂号记录</param>
		/// <returns>1-成功,-1-失败</returns>
		private int GetRegisterListByInvoice(Neusoft.HISFC.Models.Registration.Register argRegister, ArrayList alRegisters)
		{
			// 起始时间
			System.DateTime dtFrom = DateTime.MinValue;
			// 截止时间
			System.DateTime dtTo = DateTime.MinValue;

			//
			// 判断是否有时间限制,然后判断查询操作方式,执行不同的查询
			//
			if (this.boolRegisteDate)
			{
				// 获取时间限制
				this.intReturn = this.GetDateLimited(ref dtFrom, ref dtTo);
				if (this.intReturn == -1)
				{
					return -1;
				}

				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByInvoice(argRegister, alRegisters, dtFrom, dtTo, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByInvoice(argRegister, alRegisters, dtFrom, dtTo, true);
				}
			}
			else
			{
				// 判断是哪种查询操作方式
				if (this.enumOperate.Equals(OperateType.EqueQuery))
				{
					// 精确查询
					this.intReturn = function.GetRegisterListByInvoice(argRegister, alRegisters, false);
				}
				else
				{
					// 模糊查询
					this.intReturn = function.GetRegisterListByInvoice(argRegister, alRegisters, true);
				}
			}

			//
			// 判断结果
			//
			if (this.intReturn == -1)
			{
				MessageBox.Show(function.Err, "获取挂号信息失败!");
				return -1;
			}

			//
			// 成功返回
			//
			return 1;
		}
		#endregion

		#region 设置挂号信息结果FarPoint
		/// <summary>
		/// 设置挂号信息结果FarPoint
		/// [参数: ArrayList alRegister - 挂号实体数组]
		/// </summary>
		/// <param name="alRegister">挂号实体数组</param>
		private void SetRegisterFarPoint(ArrayList alRegister)
		{
			// 行号
			int row = 0;

			// 清空FarPoint
			this.ResetSheet(this.SheetRegistRecord);

			// 循环插入FarPoint
			foreach(Neusoft.HISFC.Models.Registration.Register r in alRegister)
			{
				// 增加一行
				row = this.InsertRow(this.SheetRegistRecord);
				
				// 病历号
				this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.CardCode, r.PID.CardNO);
				// 患者姓名
				this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PatientName, r.Name);
				// 挂号日期
				this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.RegisteDate, r.DoctorInfo.SeeDate.ToString());
				// 结算类别
				switch (r.Pact.PayKind.ID)
				{
					case "01":
						this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PayKindName, "自费");
						break;
					case "02":
						this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PayKindName, "医保");
						break;
					case "03":
						this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PayKindName, "公费");
                        break;
                    //case "04":
                    //    this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PayKindName, "公费退休");
                    //    break;
                    //case "05":
                    //    this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PayKindName, "公费高干");
                    //    break;
				}
				// 合同单位
				this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.PactName, r.Pact.Name);
				// 挂号级别
				this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.RegisteLevel, r.DoctorInfo.Templet.RegLevel.Name);
				// 挂号科室
				this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.RegisteDepartment, r.DoctorInfo.Templet.Dept.Name);
                // 挂号医生
                this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.RegisterDoctor, r.DoctorInfo.Templet.Doct.Name);
                // 看诊序号
                this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.SeeNo, r.DoctorInfo.SeeNO.ToString());
                //是否有效
                this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.Valid, r.Status == Neusoft.HISFC.Models.Base.EnumRegisterStatus.Valid ? "有效" : "退号");

                //退号时间
                this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.CancelDate, "--"); 

                this.SheetRegistRecord.Rows[row].BackColor = Color.White;

                if (r.Status != Neusoft.HISFC.Models.Base.EnumRegisterStatus.Valid)
                {
                    this.SheetRegistRecord.Rows[row].BackColor = Color.MistyRose;
                    //退号时间
                    this.SetCell(this.SheetRegistRecord, row, (int)RegisterField.CancelDate, r.CancelOper.OperTime.ToString()); 
                }

				// 行Tag
				this.SetRowTag(this.SheetRegistRecord, row, r);
			}
            foreach (FarPoint.Win.Spread.Column col in this.SheetRegistRecord.Columns)
            {
                col.Width = col.GetPreferredWidth();
            }
		}
		#endregion

		#region 清空FarPoint
		/// <summary>
		/// 清空FarPoint
		/// [参数: FarPoint.Win.Spread.SheetView sheet - FarPoint页]
		/// </summary>
		/// <param name="sheet">FarPoint页</param>
		private void ResetSheet(FarPoint.Win.Spread.SheetView sheet)
		{
			sheet.RowCount = 0;
		}
		#endregion
		#region 在FarPoint增加一行
		/// <summary>
		/// 在FarPoint增加一行
		/// [参数: FarPoint.Win.Spread.SheetView sheet - FarPoint页]
		/// [返回: 增加后的行号]
		/// </summary>
		/// <param name="sheet">FarPoint页</param>
		/// <returns>增加后的行号</returns>
		private int InsertRow(FarPoint.Win.Spread.SheetView sheet)
		{
			// 临时行号
			int row = 0;
			// 增加一行
			sheet.AddRows(sheet.RowCount, 1);
			// 获取行号
			row = sheet.RowCount - 1;
			// 返回行号
			return row;
		}
		#endregion
		#region 设置FarPoint一个Cell的值
		/// <summary>
		/// 设置FarPoint一个Cell的值
		/// [参数1: FarPoint.Win.Spread.SheetView sheet - FarPoint页]
		/// [参数2: int row - 行号]
		/// [参数3: int col - 列号]
		/// [参数4: string stringValue - 值]
		/// </summary>
		/// <param name="sheet">FarPoint页</param>
		/// <param name="row">行号</param>
		/// <param name="col">列号</param>
		/// <param name="stringValue">值</param>
		private void SetCell(FarPoint.Win.Spread.SheetView sheet, int row, int col, string stringValue)
		{
			sheet.Cells[row, col].Text = stringValue;
		}
		#endregion
		#region 设置FarPoint某一行的Tag
		/// <summary>
		/// 设置FarPoint某一行的Tag
		/// [参数1: FarPoint.Win.Spread.SheetView sheet - FarPoint页]
		/// [参数2: int row - 行号]
		/// [参数3: System.Object objectTag - Tag值]
		/// </summary>
		/// <param name="sheet">FarPoint页</param>
		/// <param name="row">行号</param>
		/// <param name="objectTag">Tag值</param>
		private void SetRowTag(FarPoint.Win.Spread.SheetView sheet, int row, System.Object objectTag)
		{
			sheet.Rows[row].Tag = objectTag;
		}
		#endregion
		#region 获取FarPoint某一行的Tag
		/// <summary>
		/// 获取FarPoint某一行的Tag
		/// [参数1: FarPoint.Win.Spread.SheetView sheet - FarPoint页]
		/// [参数2: int row - 行号]
		/// [返回: Tag]
		/// </summary>
		/// <param name="sheet">FarPoint页</param>
		/// <param name="row">行号</param>
		/// <returns>Tag</returns>
		private System.Object GetRowTag(FarPoint.Win.Spread.SheetView sheet, int row)
		{
			return sheet.Rows[row].Tag;
		}
		#endregion

		#region 导出
		/// <summary>
		/// 导出
		/// </summary>
		private void Export()
		{
			string Result ="";
			try
			{
				bool ret = false;
				SaveFileDialog saveFileDialog1 = new SaveFileDialog();
				saveFileDialog1.Filter = "Excel |.xls";
				if(saveFileDialog1.ShowDialog()==DialogResult.OK)
				{
					if(saveFileDialog1.FileName != "")
					{
						//以Excel 的形式导出数据
						ret = this.fpSpreadFeeDetail.SaveExcel(saveFileDialog1.FileName,FarPoint.Win.Spread.Model.IncludeHeaders.ColumnHeadersCustomOnly);
					}
					if(ret)
					{
						MessageBox.Show("成功导出数据");
					}
				}
			}
			catch(Exception ee)
			{
				Result = ee.Message;
				MessageBox.Show(Result);
			}
		}
		#endregion 

        protected override int OnQuery(object sender, object neuObject)
        {
            //if (e.Button.Equals(this.toolBarButtonQuery))
            //{
                // 如果单击了查询按钮,那么执行查询
                this.QueryRegister();
            //}
            //else if (e.Button.Equals(this.tbExpert))
            //{
            //    // 如果单击了查询按钮,那么执行查询
            //    this.Export();
            //}
            return base.OnQuery(sender, neuObject);
        }

        public override int Export(object sender, object neuObject)
        {
            //if (e.Button.Equals(this.toolBarButtonQuery))
            //{
            //    // 如果单击了查询按钮,那么执行查询
            //    this.QueryRegister();
            //}
            //else if (e.Button.Equals(this.tbExpert))
            //{
                // 如果单击了查询按钮,那么执行查询
                this.Export();
            //}
            return base.Export(sender, neuObject);
        }
	}
    
}
